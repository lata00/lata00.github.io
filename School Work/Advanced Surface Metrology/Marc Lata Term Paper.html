<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:.25in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.3in;
	text-indent:-.3in;
	line-height:107%;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:black;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:.25in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.4in;
	text-indent:-.4in;
	line-height:107%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:black;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	text-indent:-.5in;
	line-height:107%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:black;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.6in;
	text-indent:-.6in;
	line-height:107%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:black;
	font-style:italic;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.7in;
	text-indent:-.7in;
	line-height:107%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#17365D;
	font-weight:normal;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.8in;
	text-indent:-.8in;
	line-height:107%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#17365D;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.9in;
	text-indent:-.9in;
	line-height:107%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#404040;
	font-style:italic;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"Heading 8 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	text-indent:-1.0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#404040;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"Heading 9 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.1in;
	text-indent:-1.1in;
	line-height:107%;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#404040;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-link:"Caption Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Calibri",sans-serif;
	color:#1F497D;
	font-style:italic;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin:0in;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	color:black;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0in;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	color:black;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0in;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	color:black;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin:0in;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	color:black;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-link:"Subtitle Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	color:#5A5A5A;
	letter-spacing:.5pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
strong
	{color:black;}
em
	{color:windowtext;}
span.MsoPlaceholderText
	{color:gray;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-link:"Quote Char";
	margin-top:8.0pt;
	margin-right:.5in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	line-height:107%;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	color:black;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-link:"Intense Quote Char";
	margin-top:12.0pt;
	margin-right:.65in;
	margin-bottom:12.0pt;
	margin-left:.65in;
	text-align:center;
	line-height:107%;
	background:#F2F2F2;
	border:none;
	padding:0in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
span.MsoSubtleEmphasis
	{color:#404040;
	font-style:italic;}
span.MsoIntenseEmphasis
	{text-transform:uppercase;
	font-weight:bold;
	font-style:italic;}
span.MsoSubtleReference
	{font-variant:small-caps;
	color:#404040;
	text-decoration:underline;}
span.MsoIntenseReference
	{font-variant:small-caps;
	font-weight:bold;
	text-decoration:underline;}
span.MsoBookTitle
	{font-variant:small-caps;
	letter-spacing:.25pt;
	font-weight:normal;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:.25in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.3in;
	text-indent:-.3in;
	line-height:107%;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:black;
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Calibri Light",sans-serif;
	color:black;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-link:Subtitle;
	color:#5A5A5A;
	letter-spacing:.5pt;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:black;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri Light",sans-serif;
	font-variant:small-caps;
	color:black;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri Light",sans-serif;
	color:black;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Calibri Light",sans-serif;
	color:black;
	font-weight:bold;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Calibri Light",sans-serif;
	color:#17365D;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Calibri Light",sans-serif;
	color:#17365D;
	font-style:italic;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Calibri Light",sans-serif;
	color:#404040;
	font-style:italic;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-link:"Heading 8";
	font-family:"Calibri Light",sans-serif;
	color:#404040;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-link:"Heading 9";
	font-family:"Calibri Light",sans-serif;
	color:#404040;
	font-style:italic;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-link:Quote;
	color:black;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-link:"Intense Quote";
	color:black;
	background:#F2F2F2;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
p.EndNoteBibliographyTitle, li.EndNoteBibliographyTitle, div.EndNoteBibliographyTitle
	{mso-style-name:"EndNote Bibliography Title";
	mso-style-link:"EndNote Bibliography Title Char";
	margin:0in;
	text-align:center;
	line-height:107%;
	font-size:18.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#1F497D;}
span.CaptionChar
	{mso-style-name:"Caption Char";
	mso-style-link:Caption;
	color:#1F497D;
	font-style:italic;}
span.EndNoteBibliographyTitleChar
	{mso-style-name:"EndNote Bibliography Title Char";
	mso-style-link:"EndNote Bibliography Title";
	font-family:"Calibri Light",sans-serif;
	color:#1F497D;
	font-style:normal;}
p.EndNoteBibliography, li.EndNoteBibliography, div.EndNoteBibliography
	{mso-style-name:"EndNote Bibliography";
	mso-style-link:"EndNote Bibliography Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	font-size:18.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#1F497D;}
span.EndNoteBibliographyChar
	{mso-style-name:"EndNote Bibliography Char";
	mso-style-link:"EndNote Bibliography";
	font-family:"Calibri Light",sans-serif;
	color:#1F497D;
	font-style:normal;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoTitle>Physical Interpretation of MX Intensity Maps</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<p class=MsoTocHeading><span style='font-variant:normal !important;text-transform:
uppercase'>1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Table
of Contents</span></p>

</div>

<p class=MsoToc1><a href="#_Toc59142843">2<span style='color:windowtext;
text-decoration:none'>       </span>Introduction &amp; Literature Review<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc59142844">2.1<span style='color:windowtext;
text-decoration:none'>        </span>Scanning White Light Interferometry<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc59142845">2.2<span style='color:windowtext;
text-decoration:none'>        </span>Fringe-Free Intensity Images<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc1><a href="#_Toc59142846">3<span style='color:windowtext;
text-decoration:none'>       </span>Height Data vs. Intensity Data<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoToc2><a href="#_Toc59142847">3.1<span style='color:windowtext;
text-decoration:none'>        </span>Image Comparison Metrics<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoToc2><a href="#_Toc59142848">3.2<span style='color:windowtext;
text-decoration:none'>        </span>Height Map Filtering<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></p>

<p class=MsoToc1><a href="#_Toc59142849">4<span style='color:windowtext;
text-decoration:none'>       </span>Gradient Data Vs. Intensity Data<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoToc1><a href="#_Toc59142850">5<span style='color:windowtext;
text-decoration:none'>       </span>Quality Data vs. Intensity Data<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></p>

<p class=MsoToc1><a href="#_Toc59142851">6<span style='color:windowtext;
text-decoration:none'>       </span>Physical Meaning of Intensity Maps<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>16</span></a></p>

<p class=MsoToc1><a href="#_Toc59142852">7<span style='color:windowtext;
text-decoration:none'>       </span>Conclusions<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>19</span></a></p>

<p class=MsoToc1><a href="#_Toc59142853">8<span style='color:windowtext;
text-decoration:none'>       </span>Appendix I: ISO Standards<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>20</span></a></p>

<p class=MsoToc2><a href="#_Toc59142854">8.1<span style='color:windowtext;
text-decoration:none'>        </span>Root Mean Square<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>20</span></a></p>

<p class=MsoToc2><a href="#_Toc59142855">8.2<span style='color:windowtext;
text-decoration:none'>        </span>Filters<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>20</span></a></p>

<p class=MsoToc1><a href="#_Toc59142856">9<span style='color:windowtext;
text-decoration:none'>       </span>Appendix II: MATLAB CODE<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc59142857">9.1<span style='color:windowtext;
text-decoration:none'>        </span>Areal filter &amp; Image Comparisons<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc59142858">9.2<span style='color:windowtext;
text-decoration:none'>        </span>Intensity Integration<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>22</span></a></p>

<p class=MsoToc2><a href="#_Toc59142859">9.3<span style='color:windowtext;
text-decoration:none'>        </span>Create Color Mapped Intensity Image<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>22</span></a></p>

<p class=MsoToc1><a href="#_Toc59142860">10<span style='color:windowtext;
text-decoration:none'>         </span>References<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>23</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<span style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Ref59044115"></a><a name="_Toc59142843"><span style='font-variant:
normal !important;text-transform:uppercase'>2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Introduction
&amp; Literature Review</span></a></h1>

</div>

<p class=MsoNormal>In the course of working on my current research project,
which is primarily concerned with the identification of surface defects on
metal AM surfaces, the intensity map provided by scanning white light
interferometers using the MX software package has proven to be a very useful
tool in identifying regions of interest. For comparison, for the AM metal
surfaces I am interested in, here is a comparison of the height map and the intensity
map images:</p>

<p class=MsoNormal><img width=311 height=311 id="Picture 1"
src="Marc%20Lata%20Term%20Paper_files/image001.png"><img width=311 height=311
id="Picture 2" src="Marc%20Lata%20Term%20Paper_files/image002.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Ref58670188">Figure </a>2.1: Height Map (left) and Intensity Map (right)
of AM Metal Surface at 50x (FOV ~ 168 µm)</p>

<p class=MsoNormal>You can see the stark contrast in detail, especially in the
dendritic regions, which are what we are primarily interested in analyzing. The
height map shown in Figure 2.1 is not filtered, however. I will attempt to
apply spatial filtering to the height map in section 3 to see if doing this can
unveil some hidden similarities between the two representations.</p>

<p class=MsoNormal>Since I am primarily using the intensity maps in my
investigations of the defects on the surface, it would be beneficial to
understand exactly where the information utilized to construct the intensity
map is coming from, and what it means physically. The height map, which the
more traditionally utilized measurement corresponds to an obvious physical parameter
of the surface, i.e. the relative height, but there isn’t an obvious
corresponding physical significance to the intensity images. It’s also notable
that the quality of the intensity maps has improved dramatically in recent
years, giving even more reason to understand what exactly is being done to
produce these images. Is there some underlying connection to the height map
that could be unveiled and provide deeper understanding of the information being
presented?</p>

<h2><a name="_Toc59142844"><span style='font-variant:normal !important;
text-transform:uppercase'>2.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Scanning
White Light Interferometry</span></a></h2>

<p class=MsoNormal>In order to begin my analysis of the meaning of the
intensity data, I must first understand the instrument that is producing it.
These intensity maps are generated by scanning white light interferometers
(SWLI). This is a type of interferometer that uses light of a relatively short
coherence length and measures the interference signal generated on a given
sample as it scans towards or away from the sample. Because the coherence
length is short, fringes are observed only in a very limited range of distances
from the microscope objective.</p>

<p class=MsoNormal><img width=312 height=233 id="Picture 5"
src="Marc%20Lata%20Term%20Paper_files/image003.jpg"><img width=312 height=256
id="Picture 4" src="Marc%20Lata%20Term%20Paper_files/image004.jpg"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 2.2 Diagram of Scanning white light interferometer (left) and demonstration of its
operating principle (right) [1]</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal> For any given pixel being on the camera, you will get a
signal that looks like the following:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=424
height=243 id="Picture 3" src="Marc%20Lata%20Term%20Paper_files/image005.jpg"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 2.3: SWLI signal for a single pixel [1]</p>

<p class=MsoNormal>Where the peak of the modulation envelope at each pixel will
correspond to the relative height of the surface at the point the pixel is
measuring. </p>

<h2><a name="_Toc59142845"><span style='font-variant:normal !important;
text-transform:uppercase'>2.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Fringe-Free
Intensity Images</span></a></h2>

<p class=MsoNormal>Since the SWLI is a microscope, ultimately, it is capable of
taking intensity images. However, because it uses an interference objective,
the best-focus intensity image will contain the fringes that are used in the
CSI height calculation process. In order to generate fringe-free intensity
images using the SWLI microscope, we have to develop a method for removing the
fringes that will necessarily be present in images taken with it.</p>

<p class=MsoNormal>Zygo has published at least one technique that allows for
this to be accomplished. Their method is to take intensity images at every Pi/4
radians of phase and then combine them into a single image. The results from
this are shown here:</p>

<p class=MsoNormal><img width=312 height=227 id="Picture 6"
src="Marc%20Lata%20Term%20Paper_files/image006.png"><img width=312 height=223
id="Picture 7" src="Marc%20Lata%20Term%20Paper_files/image007.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 2.4: Raw Intensity (left) and Fringe-Free (right) images of an LCD panel with a
SWLI [2]</p>

<p class=MsoNormal>The image on the left demonstrates the interference fringes
that will be present in a raw intensity image taken from a SWLI. The image on
the right has attempted to remove those fringes by using the algorithm
described before. While it does appear to achieve this effect, one can see that
the detail is no where near as good as images made on modern instruments, like
that shown in Figure 2.1 for example. Because the results do not appear
consistent between this method and the images we take with our SWLI, it’s
unlikely that this is the method being used to generate these images.</p>

<p class=MsoNormal>This assumption will serve as the basis for the rest of the
paper. I am assuming that the fringe-free images are not following the algorithm
described in the Zygo publication [2].
I will also be attempting to test the null hypothesis that the new intensity images
have some connection to the heightmap, and if so whether that relationship can
be extracted and used to improve understanding of the physical meaning of the
intensity images. More generally, I will attempt to develop some meaningful
physical interpretation of the intensity map, whether it is connected to the
height map or not.<br clear=all style='page-break-before:always'>
</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Ref59044281"></a><a name="_Toc59142846"><span style='font-variant:
normal !important;text-transform:uppercase'>3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Height
Data vs. Intensity Data</span></a></h1>

</div>

<p class=MsoNormal>To begin my analysis, I’ll first address the possibility
that height map and intensity map have some underlying connection. Here again
are the sample height and intensity maps first introduced in section 2:</p>

<p class=MsoNormal><img width=311 height=311 id="Picture 13"
src="Marc%20Lata%20Term%20Paper_files/image008.png"><img width=311 height=311
id="Picture 14" src="Marc%20Lata%20Term%20Paper_files/image009.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 3.1: Height Data (left) &amp; Intensity Data (right)</p>

<p class=MsoNormal>Clearly, these do not appear at all similar except in the
broadest possible details. But just how dissimilar are they? In order to
properly assess the “similarity” of the various representations we’ll be
looking at, I must first introduce a metric that we can apply to differentiate
between “good” matches and “bad” matches. Fortunately, MATLAB natively offers a
few techniques for doing this. The two most obvious choices for this are the
Mean Squared Error, and the Structural Similarity Index. </p>

<h2><a name="_Toc59142847"><span style='font-variant:normal !important;
text-transform:uppercase'>3.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Image
Comparison Metrics</span></a></h2>

<p class=MsoNormal>The Mean Squared Error, as the name suggests, is the average
distance from the mean squared, the mean in this case being the difference
between the two relevant images. The equation is given by:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=242
height=72 id="Picture 17" src="Marc%20Lata%20Term%20Paper_files/image010.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Ref59142351">Equation </a>1: Mean Squared Error [3]</p>

<p class=MsoNormal> It is also, notably, the square of the RMS, or root mean
square. The RMS is commonly used as a measure of surface roughness of surfaces
in ISO standards. I think this makes it a compelling choice for comparing the
various images I’ll be generating. While this is a purely statistical
comparison, the Structural Similarity Index is a higher-level comparison that
attempts to go beyond purely mathematical differences and account for <i>perceptual</i>
similarities and differences. The equation is given as:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=425
height=72 id="Picture 18" src="Marc%20Lata%20Term%20Paper_files/image011.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Equation 2: Structural Similarity Index [4]</p>

<p class=MsoNormal style='margin-bottom:0in'>Where the parameters defined as:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=624
height=234 id="Picture 19" src="Marc%20Lata%20Term%20Paper_files/image012.png"></p>

<p class=MsoNormal>Because this attempts to account for similarities beyond the
purely statistical differences described by the MSE, I will also utilize this
metric when doing my comparisons. With these metrics established, I can now
attach numbers to how dissimilar these two images are:</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=299
 style='width:224.5pt;border-collapse:collapse'>
 <tr style='height:15.75pt'>
  <td width=143 nowrap valign=bottom style='width:107.5pt;border:solid windowtext 1.0pt;
  border-bottom:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Reference Image:</span></b></p>
  </td>
  <td width=156 nowrap valign=bottom style='width:117.0pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Intensity Map</span></b></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=143 nowrap valign=bottom style='width:107.5pt;border:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Comparison Image:</span></p>
  </td>
  <td width=156 nowrap valign=bottom style='width:117.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Height Map (unfiltered)</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=143 nowrap valign=bottom style='width:107.5pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>MSE:</span></p>
  </td>
  <td width=156 nowrap valign=bottom style='width:117.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>0.0942</span></p>
  </td>
 </tr>
 <tr style='height:15.75pt'>
  <td width=143 nowrap valign=bottom style='width:107.5pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>SSIM:</span></p>
  </td>
  <td width=156 nowrap valign=bottom style='width:117.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>0.2548</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoCaption align=center style='margin-top:12.0pt;text-align:center'><a
name="_Ref59052627">Table </a>3.1: MSE &amp; SSIM for Unfiltered Height Map</p>

<p class=MsoNormal>Both the intensity and height maps were normalized before
computing the comparison metrics, which will be the standard procedure. These
numbers will serve as the base line as we compare more images. A smaller MSE
than that in Table 3.1 will indicate a more similar image. Conversely, a <i>larger</i>
SSIM will indicate a better fit.</p>

<h2><a name="_Toc59142848"><span style='font-variant:normal !important;
text-transform:uppercase'>3.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Height
Map Filtering</span></a></h2>

<p class=MsoNormal>In order to achieve a better comparison between the height
map and the intensity map, I can apply a filter to remove either the high or
low frequencies from the measurement to see if that provides a better match
between the two images. For this purpose, I will use a time-domain filter, or
convolution filter.  This filter will have the following form:</p>

<p class=MsoNormal><img width=624 height=285 id="Picture 20"
src="Marc%20Lata%20Term%20Paper_files/image013.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 3.2: Gaussian Time-Domain Filter Specifications [5]</p>

<p class=MsoNormal>Using this form (modified for 2 dimensions), I can apply
both lowpass and highpass filters to the height map and attempt to identify if
there is an optimal filter that will lead to a meaningful similarity between
the two data sets. Doing this while varying the cutoff frequency and plotting
the progression of the MSE and SSIM can tell us where any local minima and
maxima of similarity might exist:</p>

<p class=MsoNormal style='page-break-after:avoid'><img width=623 height=405
id="Picture 22" src="Marc%20Lata%20Term%20Paper_files/image014.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 3.3: SSIM and MSE vs &#955;­<sub>c</sub> for Highpass and Lowpass filters</p>

<p class=MsoNormal>It appears from this plot, that our MSE is minimized and
SSIM is maximized by using a highpass filter to remove the lowest frequencies.
We can zoom in on this region to better identify our optimal cutoff frequency:</p>

<p class=MsoNormal><img width=624 height=422 id="Picture 23"
src="Marc%20Lata%20Term%20Paper_files/image015.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 3.4: SSIM and MSE vs &#955;­<sub>c</sub> for Highpass and Lowpass filters</p>

<p class=MsoNormal>Apparently, the optimal cutoff frequency for the high pass
filter is ~3 µm, with a SSIM of ~.3118. Here is a comparison of the optimally
filtered height map and the intensity map:</p>

<p class=MsoNormal><img width=311 height=311 id="Picture 24"
src="Marc%20Lata%20Term%20Paper_files/image016.png"><img width=311 height=311
id="Picture 25" src="Marc%20Lata%20Term%20Paper_files/image017.png"></p>

<p class=MsoNormal>So, while these do appear more similar than the raw height
map and the intensity map, as indicated by the slightly higher SSIM, they don’t
appear to have what you could call a meaningful relationship, beyond
representing the same region on a surface and having some minor feature
similarities.</p>

<p class=MsoNormal>Clearly there isn’t any meaningful connection directly
between the height map and the intensity map. Or at least between the <i>height</i>
and the intensity. Considering the nature of the instrument making the
intensity measurement it’s possible we can construct an appropriate model that
will interpret the height map into something that will resemble the intensity
map. The SWLI is, essentially, a reflection microscope. This operates on the
principle that the surface is illuminated from the objective, and the light that
is reflected back into the objective are detected on the camera. This means
there is a limit on how steep of surfaces can be measured, since too steep of a
surface will reflect light away from the objective. This is illustrated by the
following diagram:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=484
height=273 id="Picture 28" src="Marc%20Lata%20Term%20Paper_files/image018.jpg"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 3.5: Varying reflection angle from bumpy surface</p>

<p class=MsoNormal>From this observation, one could imagine that flat areas will
reflect more light back to the microscope than sloped areas, and the steeper
the slope the less light will be reflected. If this is the case, then the <i>gradient
</i>of the height map<i> </i>should be inversely related to the magnitude of
the intensity. I’ll test this hypothesis in the next section.</p>

<span style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc59142849"><span style='font-variant:normal !important;
text-transform:uppercase'>4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Gradient
Data Vs. Intensity Data</span></a></h1>

</div>

<p class=MsoNormal>Applying a gradient function to the height map, inverting
it, and matching the histogram to the intensity image yields the following
result:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=311
height=311 id="Picture 11" src="Marc%20Lata%20Term%20Paper_files/image019.png"><img
width=311 height=311 id="Picture 12"
src="Marc%20Lata%20Term%20Paper_files/image020.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 4.1: Gradient Map (left) and Intensity Map (right)</p>

<p class=MsoNormal>This looks much more promising than a simple filter like we were
doing before. The critical step here, I’ll note is, performing the histogram
matching, however. Without performing a histogram matching operation, the
inverted gradient map looks like this:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=203
height=203 id="Picture 29" src="Marc%20Lata%20Term%20Paper_files/image021.png"> <img
width=369 height=206 id="Picture 30"
src="Marc%20Lata%20Term%20Paper_files/image022.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 4.2: Gradient map with unmatched histogram</p>

<p class=MsoNormal>Clearly this representation does not resemble the intensity
map. Histogram matching re-bins the pixel values to better match the desired
image. While this image appears to match our target, we should still measure
just how well it matches to determine if we can say that there is any
meaningful relationship between them. Performing the same MSE and SSIM function
as before gives the following:</p>

<p class=MsoNormal><img width=624 height=446 id="Picture 31"
src="Marc%20Lata%20Term%20Paper_files/image023.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 4.3: Gradient Map MSE and SSIM vs Cut-off Wavelength for Highpass and Lowpass maps</p>

<p class=MsoNormal>Apparently, the optimal filtration for this gradient map is
none at all! The MSE and SSIM in this case are given below:</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=317
 style='width:238.0pt;border-collapse:collapse'>
 <tr style='height:15.75pt'>
  <td width=147 nowrap valign=bottom style='width:110.0pt;border:solid windowtext 1.0pt;
  border-bottom:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Reference Image:</span></b></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Intensity Map</span></b></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=147 nowrap valign=bottom style='width:110.0pt;border:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Comparison Image:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Gradient Map (unfiltered)</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=147 nowrap valign=bottom style='width:110.0pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>MSE:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>0.0233</span></p>
  </td>
 </tr>
 <tr style='height:15.75pt'>
  <td width=147 nowrap valign=bottom style='width:110.0pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>SSIM:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>0.5885</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoCaption align=center style='margin-top:12.0pt;text-align:center'>Table
4.1: MSE and SSIM for Gradient Map</p>

<p class=MsoNormal>The SSIM for this case is nearly 3x higher and the MSE is
roughly 4x lower than with the raw height map. Clearly this is a much closer
representation of the intensity map than the height map, and also provides some
insight into the origin of the intensity map’s information. However, perusing
the MX manual can perhaps provide even deeper insight!</p>

<br clear=all style='page-break-before:always'>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc59142850"><span style='font-variant:normal !important;
text-transform:uppercase'>5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Quality
Data vs. Intensity Data</span></a></h1>

</div>

<p class=MsoNormal>Looking at the manual, we find the following passage on
fringe removal algorithms:</p>

<p class=MsoNormal><img width=625 height=209 id="Picture 32"
src="Marc%20Lata%20Term%20Paper_files/image024.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 5.1: Fringe-Removal Passage from MX Manual [6]</p>

<p class=MsoNormal>According to this section, the <i>modulation</i> of the
interference signal is what is being shown in the intensity image. If you
recall, the relative location of the peak of the modulation is what determines
the height value. This implies that the relative size of the modulation peak is
what is being used for the intensity signal, as illustrated here:</p>

<p class=MsoCaption><img width=624 height=341 id="Picture 35"
src="Marc%20Lata%20Term%20Paper_files/image025.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Ref59140743">Figure </a>5.2: Modulation envelope with height and
intensity axes</p>

<p class=MsoNormal>This suggests that the height and the intensity are two
linearly independent quantities, and one can likely not be derived from the
other. This raises the question, then, how can we test the validity of the idea
that the intensity map is derived from the modulation. Thankfully, Mx happens
to record one more piece of data in addition to the intensity and the height
maps: the quality map. A quick comparison of the quality map suggests that they
might be related:</p>

<p class=MsoNormal><img width=311 height=311 id="Picture 15"
src="Marc%20Lata%20Term%20Paper_files/image026.png"><img width=312 height=312
id="Picture 16" src="Marc%20Lata%20Term%20Paper_files/image027.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 5.3: Quality Data (left) &amp; Intensity Data (right)</p>

<p class=MsoNormal>But without knowing where the “quality” map comes from this
doesn’t do us much good.  I was able to get in contact with zygo, however, and
they verified that the quality data is inherently connected to the modulation
of the signal, representing the signal-to-noise of each pixel. Knowing this, we
can compare the quality data to the intensity data to confirm that the
intensity is indeed derived from the modulation of the signal. First, I will do
a histogram match to the quality data:</p>

<p class=MsoNormal align=center style='text-align:center'><img width=307
height=307 id="Picture 36" src="Marc%20Lata%20Term%20Paper_files/image028.png"><img
width=307 height=307 id="Picture 37"
src="Marc%20Lata%20Term%20Paper_files/image027.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 5.4:Histogram Matched Quality Data (left) &amp; Intensity Data (right)</p>

<p class=MsoNormal>These look <i>very</i> similar now. Let’s check the MSE and
the SSIM to see just how similar they are:</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=311
 style='width:233.5pt;border-collapse:collapse'>
 <tr style='height:15.75pt'>
  <td width=141 nowrap valign=bottom style='width:105.5pt;border:solid windowtext 1.0pt;
  border-bottom:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Reference Image:</span></b></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Intensity Map</span></b></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=141 nowrap valign=bottom style='width:105.5pt;border:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Comparison Image:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Quality Data</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=141 nowrap valign=bottom style='width:105.5pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>MSE:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>3.13E-04</span></p>
  </td>
 </tr>
 <tr style='height:15.75pt'>
  <td width=141 nowrap valign=bottom style='width:105.5pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>SSIM:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>0.9858</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoCaption align=center style='margin-top:12.0pt;text-align:center'>Table
5.1: MSE and SSIM of Quality Data:</p>

<p class=MsoNormal>So we’ve reduced the MSE by about an order of magnitude and
added another 30 points to the SSIM, so clearly this is the best match yet. I
would go as far as saying this <i>verifies</i> that the intensity image is
derived from the modulation information given how close to zero the MSE has
become. </p>

<br clear=all style='page-break-before:always'>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc59142851"><span style='font-variant:normal !important;
text-transform:uppercase'>6<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Physical
Meaning of Intensity Maps</span></a></h1>

</div>

<p class=MsoNormal>So we have determined the origin of the intensity data. It
appears, based on a number of sources including the manual and a direct
comparison, that the intensity data comes from the modulation of the interference
signal. But what does this mean physically? Have we learned anything about the
physical meaning of the intensity signal? </p>

<p class=MsoNormal>Clearly the modulation will be proportional to the
reflectance of the surface, so it does perhaps tell us something about the
relative reflectance of each point on the surface. The fact that the gradient
of the height map appears so similar to the intensity map does also suggest
that the intensity map carries information about the slope of the surface at
any given point. In theory, then, we could integrate the intensity map and get
something that resembles the height map just as the gradient of the height map
gave use something resembling the intensity map. Doing this, and subtracting
the best fit plane gives us the following result:</p>

<p class=MsoNormal><img width=312 height=312 id="Picture 38"
src="Marc%20Lata%20Term%20Paper_files/image029.png"><img width=311 height=311
id="Picture 39" src="Marc%20Lata%20Term%20Paper_files/image030.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 6.1: Integrated Intensity map (left) &amp; Height Map (right)</p>

<p class=MsoNormal>These don’t look especially similar, but there is a moderate
resemblance between some of the various features. We can calculate the MSE and
SSIM of this as a better comparison:</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=329
 style='width:247.0pt;border-collapse:collapse'>
 <tr style='height:15.75pt'>
  <td width=159 nowrap valign=bottom style='width:119.0pt;border:solid windowtext 1.0pt;
  border-bottom:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Reference Image:</span></b></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:none;border-right:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><b><span
  style='color:black'>Height Map</span></b></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=159 nowrap valign=bottom style='width:119.0pt;border:solid windowtext 1.0pt;
  background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Comparison Image:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>Integrated Intensity</span></p>
  </td>
 </tr>
 <tr style='height:15.0pt'>
  <td width=159 nowrap valign=bottom style='width:119.0pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>MSE:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.0pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>4.37E-02</span></p>
  </td>
 </tr>
 <tr style='height:15.75pt'>
  <td width=159 nowrap valign=bottom style='width:119.0pt;border:solid windowtext 1.0pt;
  border-top:none;background:yellow;padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;line-height:normal'><span
  style='color:black'>SSIM:</span></p>
  </td>
  <td width=171 nowrap valign=bottom style='width:128.0pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:15.75pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  line-height:normal'><span style='color:black'>0.8867</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoCaption align=center style='text-align:center'>Table 6.1: SSIM and MSE for Integrated intensity</p>

<p class=MsoNormal>Wow, actually pretty good match based on the metrics! Not
too far from the gradient/intensity comparison, which makes sense since it’s
the analogous calculation. So this would suggest that magnitude of slope is not
an entirely unreasonable physical interpretation of the intensity images. </p>

<p class=MsoNormal>One additional benefit of learning that the intensity image
is derived from the modulation is the realization that the two sets of
information are linearly independent, so to speak. Referring to Figure 5.2: Modulation envelope with height and intensity axes, one is determined
from the ‘Y-axis’ and one is determined by the ‘X-axis’. This means that we can
freely superimpose these two sets of information and not fear that we are have
any underlying interferences between the two data sets. The most natural way I can
think of to do this is to simply use the height to determine the color of any
given pixel, and the intensity to determine the brightness. Doing that gives us
something that looks like:</p>

<p class=MsoNormal><img width=623 height=624 id="Picture 26"
src="Marc%20Lata%20Term%20Paper_files/image031.jpg"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 6.2: Color Mapped Intensity Image</p>

<p class=MsoNormal>This representation, in addition to looking kind of cool,
allows us to see simultaneously the information contained in the height map and
the intensity maps. </p>

<p class=MsoNormal>More specifically, this allows us to see that the dendrites,
that appeared to be sitting on a flat plane looking only at the intensity
image, are in fact on the sloped surface of a valley. I can also do things like
wrap the intensity image onto the height map, giving us something like:</p>

<p class=MsoNormal style='page-break-after:avoid'><img width=597 height=595
id="Picture 40" src="Marc%20Lata%20Term%20Paper_files/image032.jpg"></p>

<p class=MsoCaption align=center style='text-align:center'>Figure 6.3:Wrapped Intensity Map</p>

<p class=MsoNormal> </p>

<p class=MsoNormal>This view allows us to see even more clearly the structure
associated with the features visible in the intensity map.<br clear=all
style='page-break-before:always'>
</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc59142852"><span style='font-variant:normal !important;
text-transform:uppercase'>7<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Conclusions</span></a></h1>

</div>

<p class=MsoNormal>In conclusion, I was able to fairly conclusively determine
that the intensity map has no inherent relationship to the height map, whether
it is filtered or not. I was able, however, to determine that there is <i>some</i>
connection, that is more of a connection, between the intensity map and the <i>gradient
</i>of the height map. I believe that his connection is somewhat illuminating
of the physical meaning of the intensity maps, which is something like the
inverse of the slope of the surface, which intuitively makes sense in light of
the fairly conclusive determination that the intensity map is derived directly
from the modulation of the signal. For regions that are sloped more steeply, we
fully expect to get less modulation, since more light is lost and vise versa.
Integrating the intensity map and comparing to the height map somewhat verified
this notion, though only in the numerical comparisons as the visual comparison
was not entire similar.<br clear=all style='page-break-before:always'>
</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc59142853"><span style='font-variant:normal !important;
text-transform:uppercase'>8<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Appendix
I: ISO Standards</span></a></h1>

</div>

<h2><a name="_Toc59142854"><span style='font-variant:normal !important;
text-transform:uppercase'>8.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Root
Mean Square</span></a></h2>

<p class=MsoNormal>While not exactly the same as the Iso standard, the Mean
Squared Error metric utilized to determine the similarity level between the two
images (Equation 1: Mean Squared Error [3]) is <i>very</i> similar to the ISO standard
of root mean square or RMS:</p>

<p class=MsoCaption align=center style='text-align:center'><img width=312
height=117 id="Picture 41" src="Marc%20Lata%20Term%20Paper_files/image033.png"></p>

<p class=MsoCaption align=center style='text-align:center'>Equation 3: Root Mean Square</p>

<p class=MsoNormal>This definition is taken from ISO 25178-2-2020 section
4.1.1.</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc59142855"><span style='font-size:18.0pt;line-height:107%;
font-variant:normal !important;text-transform:uppercase'>8.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='font-variant:normal !important;text-transform:uppercase'>Filters</span></a></h2>

<p class=MsoNormal>I also made use of a gaussian filter, which is also governed
by Iso standards.</p>

<p class=MsoNormal>The specifications for the gaussian filter I made use of are
found in ISO 16610-61.<br clear=all style='page-break-before:always'>
</p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc59142856"><span style='font-variant:normal !important;
text-transform:uppercase'>9<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Appendix
II: MATLAB CODE</span></a><span style='font-variant:normal !important;
text-transform:uppercase'> </span></h1>

</div>

<h2><a name="_Toc59142857"><span style='font-variant:normal !important;
text-transform:uppercase'>9.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Areal
filter &amp; Image Comparisons</span></a></h2>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>close
</span><span style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>all</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>result
= zeros(1,10);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>n=1;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>figure</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>tiledlayout(4,2)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:blue'>for</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'> j =
1e-7:1e-6:1e-4</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
alpha = .4697;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
lambdac = j;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
dx = xRes;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
surfaceData = fillmissing(surfaceData,</span><span style='font-size:10.0pt;
font-family:"Courier New";color:#A020F0'>'movmedian'</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>,10);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
Sx=(-lambdac:dx:lambdac);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
Sy=(-lambdac:dx:lambdac);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
[SX,SY] = meshgrid(Sx,Sy);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
S=(1/alpha*lambdac).*exp(-pi*(sqrt(SX.^2+SY.^2)/alpha/lambdac).^2);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
N = 512;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
SD = padarray(surfaceData,[N,N], </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#A020F0'>'both'</span><span style='font-size:
10.0pt;font-family:"Courier New";color:black'>,</span><span style='font-size:
10.0pt;font-family:"Courier New";color:#A020F0'>'replicate'</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
rect = [size(S,1)/2 - N/2 size(S,1)/2 - N/2 N N];</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
S = imcrop(S,rect);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
S = S/sum(sum(S));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>    </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
I = imfilter(SD,S,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:#A020F0'>'same'</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
rect = [N N 1023 1023];</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
LP = mat2gray(imcrop(I, rect));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
HP = mat2gray(mat2gray(surfaceData) - mat2gray(LP));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>    </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
gradHP = mat2gray(imgradient(HP));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
gradHP = imhistmatch(mat2gray(1-gradHP),mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>    </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
gradLP = mat2gray(imgradient(LP));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
gradLP = imhistmatch(mat2gray(1-gradLP),mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>    </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
gradSD = mat2gray(imgradient(surfaceData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
gradSD = imhistmatch(mat2gray(1-gradSD),mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(1)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(surfaceData,[])</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(2)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(S,[]);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
title(j)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(3)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(LP,[])</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(4)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(HP,[])</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(5)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(gradLP,[])</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(6)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(gradHP,[])</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(7)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(gradSD,[])</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
nexttile(8)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
imshow(intensityData,[])</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
drawnow</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'> </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,1) = j;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,2) = ssim(mat2gray(HP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,3) = ssim(mat2gray(LP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,4) = immse(mat2gray(HP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,5) = immse(mat2gray(LP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,6) = ssim(mat2gray(gradHP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,7) = ssim(mat2gray(gradLP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,8) = immse(mat2gray(gradHP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,9) = immse(mat2gray(gradLP), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
result(n,10)= ssim(mat2gray(gradSD), mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>    </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>   
n = n + 1;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:blue'>end</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:blue'> </span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>figure</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>plot(result(:,1),
result(:,2),result(:,1), result(:,3),result(:,1), result(:,4),result(:,1),
result(:,5),result(:,1), result(:,6),result(:,1), result(:,7), result(:,1), result(:,8),result(:,1),
result(:,9),result(:,1), result(:,10))</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>legend(</span><span
style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>'Highpass
SSIM'</span><span style='font-size:10.0pt;font-family:"Courier New";color:black'>,
</span><span style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>'Lowpass
SSIM'</span><span style='font-size:10.0pt;font-family:"Courier New";color:black'>,
</span><span style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>'Highpass
MSE'</span><span style='font-size:10.0pt;font-family:"Courier New";color:black'>,
</span><span style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>'Lowpass
MSE'</span><span style='font-size:10.0pt;font-family:"Courier New";color:black'>,
</span><span style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>'Gradien
Highpass SSIM'</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>, </span><span style='font-size:10.0pt;font-family:"Courier New";
color:#A020F0'>'Gradient Lowpass SSIM'</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>, </span><span style='font-size:10.0pt;
font-family:"Courier New";color:#A020F0'>'Gradient Highpass MSE'</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'>, </span><span
style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>'Gradient
Lowpass MSE'</span><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>,</span><span style='font-size:10.0pt;font-family:"Courier New";
color:#A020F0'>'Gradient Surface Data'</span><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>)</span></p>

<h2><a name="_Toc59142858"><span style='font-variant:normal !important;
text-transform:uppercase'>9.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Intensity
Integration</span></a></h2>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>iHMx
= cumtrapz(x,mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>iHMy
= rot90(cumtrapz(y,rot90(mat2gray(intensityData))),3);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>z =
mat2gray(iHMx + iHMy);</span></p>

<h2><a name="_Toc59142859"><span style='font-variant:normal !important;
text-transform:uppercase'>9.3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-variant:normal !important;text-transform:uppercase'>Create
Color Mapped Intensity Image</span></a></h2>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>HSV
= ones(1024,1024,3)*.75;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>HSV(:,:,1)
= mat2gray(surfaceData);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>HSV(:,:,3)
= histeq(mat2gray(intensityData));</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>RGB
= hsv2rgb(HSV);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>nexttile</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>imshow(RGB);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>[X,Y]
= meshgrid(1:1024,1:1024);</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>nexttile</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>warp(X,Y,surfaceData,RGB)</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>colormap
</span><span style='font-size:10.0pt;font-family:"Courier New";color:#A020F0'>hsv</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:10.0pt;font-family:"Courier New";color:black'>colorbar</span></p>

<span style='font-size:10.0pt;line-height:107%;font-family:"Courier New";
color:black'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span style='font-size:10.0pt;line-height:107%;font-family:
"Courier New";color:black'>&nbsp;</span></p>

<div style='border:none;border-bottom:solid #595959 1.0pt;padding:0in 0in 1.0pt 0in'>

<h1><a name="_Toc59142860"><span style='font-variant:normal !important;
text-transform:uppercase'>10<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-variant:normal !important;text-transform:uppercase'>References</span></a></h1>

</div>

<p class=EndNoteBibliography style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:.5in;text-indent:-.5in'>1.      Leach, R., <i>Optical Measurement
of Surface Topography</i>. 2011, Springer Berlin / Heidelberg: Berlin,
Heidelberg.</p>

<p class=EndNoteBibliography style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:.5in;text-indent:-.5in'>2.      de Groot, P., <i>Generating
fringe-free images from phase-shifted interferometry data.</i> Applied Optics,
2005. <b>44</b>(33): p. 7062-7069.</p>

<p class=EndNoteBibliography style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:.5in;text-indent:-.5in'>3.      <i>Mean Squared Error</i>.
Available from: <a href="https://en.wikipedia.org/wiki/Mean_squared_error">https://en.wikipedia.org/wiki/Mean_squared_error</a>.</p>

<p class=EndNoteBibliography style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:.5in;text-indent:-.5in'>4.      <i>Structural Similarity</i>.
Available from: <a href="https://en.wikipedia.org/wiki/Structural_similarity">https://en.wikipedia.org/wiki/Structural_similarity</a>.</p>

<p class=EndNoteBibliography style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:.5in;text-indent:-.5in'>5.      Evans, C., <i>Advanced Surface
Metrology - Filtering</i>. 2020.</p>

<p class=EndNoteBibliography style='margin-left:.5in;text-indent:-.5in'>6.      <i>Mx
Reference Guide</i>, in <i>Modulation vs. Weighted Average</i>. 2020, Ametek:
zygo.com.</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
